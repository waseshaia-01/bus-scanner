<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Bus Boarding Dashboard</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 10px;
        background: #f8f9fa;
    }
    .bus-card {
        background: white;
        margin-bottom: 10px;
        border-radius: 8px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.2);
        overflow: hidden;
    }
    .bus-header {
        padding: 10px;
        background: #333;
        color: white;
        font-weight: bold;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .bus-count {
        background: orange;
        color: white;
        border-radius: 50%;
        padding: 3px 8px;
        font-size: 12px;
    }
    .bus-body {
        display: none;
        padding: 10px;
    }
    .btn {
        display: inline-block;
        padding: 8px 12px;
        margin: 5px 5px 10px 0;
        border-radius: 5px;
        color: white;
        cursor: pointer;
    }
    .btn-upload { background: #007bff; }
    .btn-qr { background: #f39c12; }
    .attendee {
        padding: 5px 0;
        border-bottom: 1px solid #ddd;
    }
    #generatedQRCodes {
        margin-top: 10px;
        display: flex;
        flex-wrap: wrap;
        gap: 10px;
    }
    .qr-wrapper {
        text-align: center;
    }
    .qr-wrapper canvas {
        display: block;
        margin: auto;
    }
</style>
</head>
<body>

<h2>ðŸšŒ Bus Boarding Dashboard</h2>

<div id="busContainer"></div>

<!-- QRCode Library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script>
// Demo data - Replace with Firestore data fetch
const buses = {
    Bus1: ["Michael Reyes", "Sarah Tan"],
    Bus2: ["Jessa Saavedra"],
    Bus3: [],
    Bus4: [],
};

function createBusCard(busName, attendees) {
    const card = document.createElement("div");
    card.className = "bus-card";

    const header = document.createElement("div");
    header.className = "bus-header";
    header.innerHTML = `<span>${busName}</span> <span class="bus-count">${attendees.length}</span>`;
    card.appendChild(header);

    const body = document.createElement("div");
    body.className = "bus-body";

    // Buttons
    const uploadBtn = document.createElement("div");
    uploadBtn.className = "btn btn-upload";
    uploadBtn.textContent = "Upload Attendees";
    body.appendChild(uploadBtn);

    const qrBtn = document.createElement("div");
    qrBtn.className = "btn btn-qr";
    qrBtn.textContent = "Generate QR Codes";
    body.appendChild(qrBtn);

    // Attendee list
    attendees.forEach(name => {
        const div = document.createElement("div");
        div.className = "attendee";
        div.textContent = name;
        body.appendChild(div);
    });

    // QR Container
    const qrContainer = document.createElement("div");
    qrContainer.id = `qr-${busName}`;
    qrContainer.className = "generatedQRCodes";
    body.appendChild(qrContainer);

    card.appendChild(body);

    // Toggle behavior
    header.addEventListener("click", () => {
        const isVisible = body.style.display === "block";
        document.querySelectorAll(".bus-body").forEach(b => b.style.display = "none");
        if (!isVisible) {
            body.style.display = "block";
        }
    });

    // QR Button Click
    qrBtn.addEventListener("click", () => {
        qrContainer.innerHTML = "";
        attendees.forEach(name => {
            const wrapper = document.createElement("div");
            wrapper.className = "qr-wrapper";
            const qrDiv = document.createElement("div");
            new QRCode(qrDiv, {
                text: name,
                width: 80,
                height: 80
            });
            const label = document.createElement("div");
            label.textContent = name;
            label.style.fontSize = "12px";
            wrapper.appendChild(qrDiv);
            wrapper.appendChild(label);
            qrContainer.appendChild(wrapper);
        });
    });

    return card;
}

function renderBuses() {
    const container = document.getElementById("busContainer");
    container.innerHTML = "";
    for (let bus in buses) {
        container.appendChild(createBusCard(bus, buses[bus]));
    }
}

renderBuses();
</script>

</body>
</html>
